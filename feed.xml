<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.3.2">Jekyll</generator><link href="https://usegalaxy.github.io/feed.xml" rel="self" type="application/atom+xml" /><link href="https://usegalaxy.github.io/" rel="alternate" type="text/html" /><updated>2023-11-20T23:45:11+00:00</updated><id>https://usegalaxy.github.io/feed.xml</id><title type="html">Galaxy 中国</title><subtitle>The European Galaxy Instance</subtitle><entry><title type="html">出版级柱状图绘制，轻松拿捏（初学者友好的R包ggpubr在线版）</title><link href="https://usegalaxy.github.io/posts/2023/11/20/tool-update/" rel="alternate" type="text/html" title="出版级柱状图绘制，轻松拿捏（初学者友好的R包ggpubr在线版）" /><published>2023-11-20T00:00:00+00:00</published><updated>2023-11-20T00:00:00+00:00</updated><id>https://usegalaxy.github.io/posts/2023/11/20/tool-update</id><content type="html" xml:base="https://usegalaxy.github.io/posts/2023/11/20/tool-update/"><![CDATA[## 工具地址

Galaxy中国（UseGalaxy.cn）> Graph/Display Data > 柱状图


## 功能描述

这个工具可以绘制出版级柱状图，是 ggpubr 包的 barplot 工具的在线版。

- 条形图通过垂直或水平的条形展示分类变量的分布（频数）。
- 横坐标表示分类，纵坐标表示频数，频数既可以事先计算好，也可以自动计算（不指定 Y 变量时）。

## 测试数据

> Data libraries > Table data > ToothGrowth.tsv。

![](/assets/img/231120-tool-update-barplot-data.png)

## 操作演示

> - 数据表：ToothGrowth.tsv
- 位置美学：
  - X 轴变量：dose

![](/assets/img/231120-tool-update-barplot-dose.png)

> - 重新运行上一步
- 位置美学：
  - Y 轴变量：len

![](/assets/img/231120-tool-update-barplot-dose-len.png)

> - 重新运行上一步
- 颜色美学：
  - 轮廓颜色：supp
  - 填充颜色：supp

![](/assets/img/231120-tool-update-barplot-dose-color-fill-supp.png)

> - 重新运行上一步
- 高级设置：
  - dodge：dodge2

![](/assets/img/231120-tool-update-barplot-dose-color-fill-supp-dodge2.png)

> - 重新运行上一步
- 高级设置：
  - 添加元素：mean_se

![](/assets/img/231120-tool-update-barplot-dose-color-fill-supp-dodge2-mean_se.png)

> - 重新运行上一步
- 颜色美学：
  - 调色板：JCO

![](/assets/img/231120-tool-update-barplot-dose-color-fill-supp-dodge2-jco.png)

> - 重新运行上一步
- 颜色美学：
  - 主题：theme_dark

![](/assets/img/231120-tool-update-barplot-dose-color-fill-supp-dodge2-jco-theme_dark.png)


## 友情提示

使用问题请加入**Galaxy中国交流群: 925694514（QQ群，免费加入）**，或者关注公众号：**简说基因**。

![](/assets/media/wechat-qq-group.jpg)]]></content><author><name></name></author><category term="tools" /><summary type="html"><![CDATA[工具地址]]></summary></entry><entry><title type="html">出版级PCA美图，轻松拿捏（主成分分析利器，建议收藏备用）</title><link href="https://usegalaxy.github.io/posts/2023/11/16/tool-update/" rel="alternate" type="text/html" title="出版级PCA美图，轻松拿捏（主成分分析利器，建议收藏备用）" /><published>2023-11-16T00:00:00+00:00</published><updated>2023-11-16T00:00:00+00:00</updated><id>https://usegalaxy.github.io/posts/2023/11/16/tool-update</id><content type="html" xml:base="https://usegalaxy.github.io/posts/2023/11/16/tool-update/"><![CDATA[## 功能描述

这个工具用于进行主成分分析（PCA, Principal Component Analysis），可生成出版级的图形。

## 工具位置

[UseGalaxy.cn > RNA-seq > PCA plot with FactoMineR](https://usegalaxy.cn/?tool_id=plot_pca&version=0.6)

## 数据准备

### 文件1：矩阵文件

- 第1列：特征，如基因。 
- 第2 - 最后一列：样本的值，如表达量。
![](/assets/img/231116-tool-update-pca-data-count.png)


### 文件2：样本信息

- 第1列：样本ID。
- 第2列：分组。
![](/assets/img/231116-tool-update-pca-data-group.png)


## 使用示例

> - 默认参数

![](/assets/img/231116-tool-update-pca-default.png)

> - 高级设置
    - 边界线形状：多边形

![](/assets/img/231116-tool-update-pca-adv-poly.png)


> - 高级设置
  - 边界线形状：无边界线

![](/assets/img/231116-tool-update-pca-adv-no.png)

> - 颜色美学
  - 主题：theme_minimal

![](/assets/img/231116-tool-update-pca-minimal.png)


> - 颜色美学
  - 调色板为：JCO

![](/assets/img/231116-tool-update-pca-jco.png)

> - 图例设置
  - 位置：right

![](/assets/img/231116-tool-update-pca-legend-right.png)


## 友情提示

使用问题请加入**Galaxy中国交流群: 925694514（QQ群，免费加入）**，或者关注公众号：**简说基因**。

![](/assets/media/wechat-qq-group.jpg)]]></content><author><name></name></author><category term="tools" /><summary type="html"><![CDATA[功能描述]]></summary></entry><entry><title type="html">使用Tiverse优雅地处理数据集</title><link href="https://usegalaxy.github.io/posts/2023/11/10/tool-update/" rel="alternate" type="text/html" title="使用Tiverse优雅地处理数据集" /><published>2023-11-10T00:00:00+00:00</published><updated>2023-11-10T00:00:00+00:00</updated><id>https://usegalaxy.github.io/posts/2023/11/10/tool-update</id><content type="html" xml:base="https://usegalaxy.github.io/posts/2023/11/10/tool-update/"><![CDATA[2023-11-10，Galaxy生信云平台 [UseGalaxy.cn](https://usegalaxy.cn) 新增 12 个工具。

## TIDYVERSE

- Dplyr Arrange rows
- Dplyr Count the observations
- Dplyr Distinct keep unique rows
- Dplyr Join two tables
- Dplyr Join with one varibale
- Dplyr Mutate create, modify, and delete columns
- Dplyr Rename columns
- Dplyr Select keep or drop columns
- Dplyr Slice select rows by position
- Dplyr Filter keep rows that match a condition
- Tidyr Pivot Longer from wide
- Tidyr Pivot Wider from long

## Dplyr Arrange rows

`arrange` 函数用于对数据框按照指定变量进行排序，可以根据一个或多个变量对数据进行升序或降序排列，帮助用户重新整理数据框中的观测顺序。

## Dplyr Count the observations

`count` 函数用于统计数据框中各个组的频数，可以对指定变量进行计数，得到每个类别的观测数目，支持根据需要对结果进行排序。

## Dplyr Distinct keep unique rows

`distinct` 函数用于去除数据框中的重复观测，仅保留唯一的观测。它可以基于指定的列对数据框进行去重操作，确保每个观测都是唯一的。

## Dplyr Join two tables

`join` 函数用于根据指定的键将两个数据框连接起来，可以根据共同的变量将数据框进行合并，支持多种连接操作，如内连接、左连接、右连接和外连接等。

## Dplyr Join with one varibale

同上。区别在于只用一个变量连接两个表。

## Dplyr Mutate create, modify, and delete columns

`mutate` 函数用于添加新变量或修改现有变量，能够基于已有数据创建新的变量列，支持对数据框进行实时的变量操作和修改。

## Dplyr Rename columns

`rename` 函数用于重命名数据框中的变量名，能够快速修改变量的名称，使得数据的列名更符合用户的需求和习惯。

## Dplyr Select keep or drop columns

`select` 函数用于选择数据框中的特定列，可以保留感兴趣的变量，并且能够根据列名、位置或条件表达式进行灵活的变量选择操作。

## Dplyr Slice select rows by position

`slice` 函数用于按行数进行切片，能够从数据框中提取特定的行，支持根据行数或行号选择需要的行，也支持使用负数表示从末尾开始计算的行数。

## Dplyr Filter keep rows that match a condition

`filter` 函数用于根据条件筛选数据行，能够仅保留满足条件的观测，支持根据指定的条件表达式对数据框进行灵活的行筛选操作。

## Tidyr Pivot Longer from wide

`pivot_longer` 函数用于将宽格式数据转换为长格式数据，能够根据用户指定的列将数据框中的多个列整理成一对 "名-值" 对，便于进一步的分析和处理。

## Tidyr Pivot Wider from long

`pivot_wider` 函数用于将长格式数据转换为宽格式数据，能够将数据框中的一列分成多个列，根据指定的列名进行展开，使得数据以更直观的宽格式形式呈现。

## 友情提示

使用问题请加入**Galaxy中国交流群: 925694514（QQ群，免费加入）**，或者关注公众号：**简说基因**。

![](/assets/media/wechat-qq-group.jpg)]]></content><author><name></name></author><category term="tools" /><summary type="html"><![CDATA[2023-11-10，Galaxy生信云平台 UseGalaxy.cn 新增 12 个工具。]]></summary></entry><entry><title type="html">UseGalaxy.cn生信云平台文本文件操作手册</title><link href="https://usegalaxy.github.io/posts/2023/11/08/training/" rel="alternate" type="text/html" title="UseGalaxy.cn生信云平台文本文件操作手册" /><published>2023-11-08T00:00:00+00:00</published><updated>2023-11-08T00:00:00+00:00</updated><id>https://usegalaxy.github.io/posts/2023/11/08/training</id><content type="html" xml:base="https://usegalaxy.github.io/posts/2023/11/08/training/"><![CDATA[文本文件是生物信息学中应用非常广泛的文本格式，甚至可以说是最重要的文件格式，比如常见的测序下机数据Fastq、参考基因组保存格式Fasta、比对文件SAM，以及突变列表VCF，它们都是文本文件。熟练地进行文本文件的处理，对于生信数据分析来说非常重要。比如为特定程序准备相应的输入文件，或者从结果文件中提取需要的信息。

文本文件的操作贯穿生信数据处理的始终，甚至有人开玩笑说，搞生信分析，就是进行各种文件格式的转换。有时候确实可以这么说，因为现在有许多软件/包都写得非常完善了，只需要准备好相应的输入文件，一行代码即可完成分析。

可以说，善于文本文件的处理，生信数据分析就站在了一个非常高的起点。[UseGalaxy.cn](https://usegalaxy.cn)平台有非常强大的文本数据处理功能，本文就来系统地介绍这些文本处理工具的用法。

## 测序数据

- Libraries > Table data: heatmap_test.tsv，一个模拟的 RNA-seq 表达量矩阵数据。

## 1. 文本操纵（Text Manipulation）

### 选择开始的多少行

**工具：**Text Manipulation > Select first lines from a dataset

**目标：**选择前10行

**操作：**

- Select first: 11 (因为文件有表头，所以这里设置为前11行)
- from: heatmap_test.tsv

**结果：**

![](/assets/img/231108-training-select-first.png)

### 选择结尾的多少行

**工具：** Text Manipulation > Select last lines from a dataset

**目标：** 选择结尾的10行

**操作：**

- Select last: 10
- from: heatmap_test.tsv
- Dataset has a header: Yes 

**结果：**

![](/assets/img/231108-training-select-last.png)

### 随机选择多少行


**工具：** Text Manipulation > Select random lines from a file

**目标：** 随机选择5行

**操作：**

- Randomly select: 5
- from: heatmap_test.tsv

**结果：**

![](/assets/img/231108-training-select-random.png)

### 删除开始的多少行

**工具：** Text Manipulation > Remove beginning of a file

**目标：** 删除表头

**操作：**

- Remove first: 1
- from: heatmap_test.tsv

**结果：**

![](/assets/img/231108-training-remove-begining.png)

### 选择列

**工具：** Text Manipulation > Cut columns from a table

**目标：** 选择第1，2，5列

**操作：**

- Cut columns: c1,c2,c5
- from: heatmap_test.tsv

**结果：**

![](/assets/img/231108-training-cut.png)

### 增加列到一个数据表

**工具：** Text Manipulation > Add column to an existing dataset

**目标：** 在最后一列增加一个**+**号

**操作：**

- Add this value：+
- to Dataset: Remove beginning on data 1
- Iterate?: NO

**结果：**

![](/assets/img/231108-training-add-plus.png)

**目标：** 在最后一列增加从1开始不断迭代的编号

**操作：**

- Add this value：1
- to Dataset: Remove beginning on data 1
- Iterate?: YES

**结果：**

![](/assets/img/231108-training-add-1.png)

### 纵向合并多个文件

**工具：** Text Manipulation > Concatenate datasets tail-to-head

**目标：** 合并两个文件

**操作：**

- Concatenate Dataset: Select first on data 1
- Dataset: Select last on data 1

**结果：**

![](/assets/img/231108-training-cat.png)

### 横向合并两个文件

**工具：** Text Manipulation > Paste two files side by side

**目标：** 并排粘贴两个文件

**操作：**

- Paste: Cut on data 1
- and: Cut on data 1
- Delimit by: TAB

**结果：**

![](/assets/img/231108-training-paste.png)

## 2. 过滤和排序（Filter and Sort）

### 根据正则表达式匹配行

**工具：** Filter and Sort > Select lines that match an expression

**目标：** 筛选出前面纵向合并的文件中的表头

**操作：**

- Select lines from: Concatenate datasets on data 4 and data 2
- that: Matching
- the pattern: Test1

**结果：**

![](/assets/img/231108-training-grep.png)

**目标：** 筛选出前面纵向合并的文件中不是表头的行

**操作：**

- Select lines from: Concatenate datasets on data 4 and data 2
- that: NOT Matching
- the pattern: Test1

**结果：**

![](/assets/img/231108-training-grep-v.png)

### 依据某一列过滤数据

**工具：** Filter and Sort > Filter data on any column using simple expressions

**目标：** 筛选第2列（即样本Test1所在列）值大于1的行

**操作：**

- Filter：heatmap_test.tsv
- With following condition: c2 > 1
- Number of header lines to skip: 1

**结果：**

![](/assets/img/231108-training-filter-by-column.png)

### 排序数据

**工具：** Filter and Sort > Sort data in ascending or descending order

**目标：** 根据表达矩阵的第2列，降序排列行

**操作：**

- Sort Dataset: heatmap_test.tsv
- on column: Column 2
- with flavor: Numerical sort
- everything in: Descending order
- Number of header lines to skip: 1 

**结果：**

![](/assets/img/231108-training-sort-desc.png)

## 3. 连接、提取和分组（Join, Subtract and Group）

### 依据特定列连接两个数据表

**工具：** Text Manipulation > Cut columns

**目标：** 选择文件前3列

**操作：**
- Cut columns: c1,c2, c3
- From: Select first on data 1

**工具：** Join, Subtract and Group > Join two Datasets side by side on a specified field

**目标：** 连接两个数据表

**操作：**
- Join: Cut on data 2
- using column: Column: 1
- with: heatmap_test.tsv
- and column: Column: 1

**结果：**

![](/assets/img/231108-training-join.png)


### 比较两个数据表找出相同或不同的行

**工具：** Join, Subtract and Group > Compare two Datasets to find common or distinct rows

**目标：** 查找表1中，某一列的值出现在表2中某一列的行

**操作：**

- Compare：Select random lines on data 1
- Using column: Column: 1
- against：heatmap_test.tsv
- and column：Column: 1
- To find: Matching rows of 1st dataset

**结果：**

![](/assets/img/231108-training-compare-match.png)

**目标：** 查找表1中，某一列的值没有出现在表2中某一列的行

**操作：**

- Compare：Select random lines on data 1
- Using column: Column: 1
- against：heatmap_test.tsv
- and column：Column: 1
- To find: Non Matching rows of 1st dataset

**结果：**

因为表1所有的行，都在表2中，因此结果为空。

## 友情提示

使用问题请加入**Galaxy中国交流群: 925694514（QQ群，免费加入）**，或者关注公众号：**简说基因**。

![](/assets/media/wechat-qq-group.jpg)]]></content><author><name></name></author><category term="tools" /><summary type="html"><![CDATA[文本文件是生物信息学中应用非常广泛的文本格式，甚至可以说是最重要的文件格式，比如常见的测序下机数据Fastq、参考基因组保存格式Fasta、比对文件SAM，以及突变列表VCF，它们都是文本文件。熟练地进行文本文件的处理，对于生信数据分析来说非常重要。比如为特定程序准备相应的输入文件，或者从结果文件中提取需要的信息。]]></summary></entry><entry><title type="html">生物信息必备技能-出版级别的circos圈图绘制</title><link href="https://usegalaxy.github.io/posts/2023/11/06/tool-update/" rel="alternate" type="text/html" title="生物信息必备技能-出版级别的circos圈图绘制" /><published>2023-11-06T00:00:00+00:00</published><updated>2023-11-06T00:00:00+00:00</updated><id>https://usegalaxy.github.io/posts/2023/11/06/tool-update</id><content type="html" xml:base="https://usegalaxy.github.io/posts/2023/11/06/tool-update/"><![CDATA[2023-11-06，Galaxy生信云平台 [UseGalaxy.cn](https://usegalaxy.cn) 新增circos圈图绘制工具。

## Graph/Display Data

- Circos visualizes data in a circular layout (Galaxy Version 0.69.8+galaxy12)

Circos（Krzywinski等人，2009年）是一个用于以圆形布局可视化数据的软件包。这使得Circos非常适合探索对象或位置之间的关系。Circos图表已经出现在成千上万的科学出版物中。尽管最初设计用于可视化基因组数据，但它可以根据任何领域的数据创建图表。

## 文章图形复现

图形/数据来源：

> Teles Alves I, Hiltemann S, Hartjes T, et al. Gene fusions by chromothripsis of chromosome 5q in the VCaP prostate cancer cell line. Hum Genet. 2013;132(6):709-713. doi:10.1007/s00439-013-1308-1

![](/assets/img/231106-tool-update-circos-target.png)

在这篇文章中，各种来源的数据被整合到一个综合的Circos图中。下面我们就来复现这个图，首先我们先了解一下Circos的基础。


### 1. Circos基础

#### 1.1 外层骨架（Ideogram）

对于基因组数据，通常是染色体，但也可能是物种、基因，或者是另一个分辨率级别，这取决于你想要展示的关系。对于非基因组数据，这可能是人群中的个体、国家，或者是你想用来进行分组的数据的任何其他主要方面。

#### 1.2 数据轨道（Data Tracks）

在骨架之内，我们可以绘制数据轨道。有不同类型的图表可用，例如：

- 散点图（Scatter plot）
- 线图（Line plot）
- 直方图（Histogram）
- 热图（Heatmap）
- 方块图（Tile）
- 文本（Text）
- 连接（Link）
- 条带（Ribbons）

轨道可以进行很多定制，一些相关的概念包括：

- **Radius**：轨道的半径决定了它在中心（0）和表意图（1）之间的位置。

- **Rules**：可以定义规则，根据数据点的值改变数据点的颜色，例如。

- **Axes and backgrounds**：可以在数据轨道上绘制轴和背景。

### 2. 复现步骤

工具位置：UseGalaxy.cn首页 > Graph/Display Data > Circos visualizes data in a circular layout

或者：[https://usegalaxy.cn/root?tool_id=toolshed.g2.bx.psu.edu/repos/iuc/circos/circos/0.69.8+galaxy12](https://usegalaxy.cn/root?tool_id=toolshed.g2.bx.psu.edu/repos/iuc/circos/circos/0.69.8+galaxy12)


#### 2.1 数据准备

可以下载原文中的数据上传到网站：

```
https://zenodo.org/record/4494146/files/VCaP_Copy-Number.tsv
https://zenodo.org/record/4494146/files/VCaP_B-allele-Frequency.tsv
https://zenodo.org/record/4494146/files/VCaP-highConfidenceJunctions.tsv
https://zenodo.org/record/4494146/files/hg18_karyotype_withbands.txt
```

或者用网站上整理好的共享数据：

网站首页（UseGalaxy.cn）> 数据共享 > 数据库 > circos，该目录下有4个测试文件：

- hg18_karyotype_withbands.txt，染色体骨架文件
- circos-sv.tsv，结构变异信息
- circos-cnv.tsv，拷贝数变异信息
- circos-baf.tsv，次等位基因频率

#### 2.2 Ideogram

由于圈图要呈现的数据很多，参数设置复杂，因此不可能一次就画好，而是有一个不断迭代的过程，一圈一圈地画。

**操作：设置Ideogram**

我们首先只设置骨架文件，其他参数保持默认：

![](/assets/img/231106-tool-update-circos-1-karyotype.png)

运行看看结果：

![](/assets/img/231106-tool-update-circos-1-karyotype-result.png)

可以看到，只有一个圈。

我们接着设置：

![](/assets/img/231106-tool-update-circos-1-karyotype-setting.png)

点击“Run Tool”，等待运行结束，点击结果文件右边的铅笔图标，将文件改名为：**Circos Plot ideogram**。

![](/assets/img/231106-tool-update-circos-1-karyotype-result-ok.png)

**小知识：**

> 染色体定义的格式如下：chr - ID LABEL START END COLOR
>
> 前两个字段始终是**chr**，表示该行定义了一个染色体，以及 **-**。第二个字段定义了父结构，仅用于染色体条带定义。
>
> **ID** 是数据文件中使用的标识符，而 **LABEL** 是将出现在图像上的骨架旁边的文本。
>
> **START**和**END**定义了染色体的大小。核型文件应该存储整个染色体的大小，而不仅仅是您希望绘制的区域。我们可以使用其他参数仅绘制数据的子集（例如，只有一个染色体）。
>
> **COLOR**参数是可选的，要使用内置的颜色方案，请再次在此列中使用chr1、chr2等。


#### 2.3 数据轨道一：结构变异

结构变异需要提供两个断点的位置，如下：

```
chromosome    start    end    chromosome    start    end
```

- 第一个断点的染色体编号，开始位置，结束位置
- 第二个断点的染色体编号，开始位置，结束位置

![](/assets/img/231106-tool-update-circos-2-sv-data.png)


**操作：添加结构变异的连线轨道**

1. 点击右侧历史记录中的**Circos Plot ideogram**文件名，点击“Run Job Again”（一个转圈的箭头）

2. 结构变异轨道参数设置：

![](/assets/img/231106-tool-update-circos-2-sv-setting.png)


![](/assets/img/231106-tool-update-circos-2-sv-result1.png)

可以看到，5号染色体有许多染色体内的结构变异，我们可以单独画出5号染色体的结构变异。


最后， 将结果文件改名为：**Circos Plot SVs**

**操作：只画5号染色体**

1. 重新运行刚才的工具

2. 改变参数设置：

![](/assets/img/231106-tool-update-circos-2-sv-chr5-setting.png)

得到如下图片：

![](/assets/img/231106-tool-update-circos-2-sv-chr5.png)


#### 2.4 数据轨道二：拷贝数变异

拷贝数变异需要准备的数据格式：

```
chr    start    end    value
```
- chr，染色体
- chr，变异开始位置
- end, 变异结束位置
- value，变异倍数

![](/assets/img/231106-tool-update-circos-3-cnv-data.png)


**操作：增加拷贝数轨道**

1. 重新运行画“Circos Plot SVs”的工具。

2. 增加一个散点图轨道到图形中：

![](/assets/img/231106-tool-update-circos-3-cnv-setting.png)

结果如下：

![](/assets/img/231106-tool-update-circos-3-cnv-result1.png)

可以看到，拷贝数轨道与结构变异轨道重叠了。这是因为没有个性结构变异轨道的半径设置：

3. 重新运行工具，改变以下参数：

```
In "Link Tracks":
    - In "1: Link Data":
        - "Inside Radius": 0.75
```

应该看到这样的图：

![](/assets/img/231106-tool-update-circos-3-cnv-result2.png)


**操作：用不同颜色标记拷贝数变异状态**

1. 重新运行上一步的结果

2. 在**2D data track**的拷贝数轨道中，增加以下规则：

![](/assets/img/231106-tool-update-circos-3-cnv-setting2.png)

应该得到如下结果：

![](/assets/img/231106-tool-update-circos-3-cnv-result3.png)

**操作：为拷贝数轨道增加坐标轴**

1. 重新运行刚才的结果

2. 在**2D data track**中的拷贝数轨道设置页面：

![](/assets/img/231106-tool-update-circos-3-cnv-setting3.png)

结果如下：

![](/assets/img/231106-tool-update-circos-3-cnv-final.png)


最后， 重命名结果文件为：**Circos Plot CopyNumber**

#### 2.5 数据轨道三：次等位基因频率

数据格式与拷贝数变异的类似，也是准备4列数据：

```
chr    start    end    value
```

**操作：增加次等位基因频率到图中**

1. 重新运行刚才的工具（**Circos Plot CopyNumber**）

2. 增加新的散点图轨道到图中：

![](/assets/img/231106-tool-update-circos-4-b-allel-setting.png)

最后， 重命名结果文件：**Circos Plot BAF**

结果图：

![](/assets/img/231106-tool-update-circos-4-b-allel-result.png)

#### 2.6 存在问题：如何将结构变异轨道拆分成两个

**操作：两个连接轨道**

1. 重新运行刚才的工具（**Circos Plot BAF**）

2. 配置两个单独的连接轨道

![](/assets/img/231106-tool-update-circos-5-question-setting1.png)
![](/assets/img/231106-tool-update-circos-5-question-setting2.png)

最后结果：

![](/assets/img/231106-tool-update-circos-6-recreate-final.png)

可以看到，跟原图完全一样，可以说复现效果达到了100%。

## 友情提示

使用问题请加入**Galaxy中国交流群: 925694514（QQ群，免费加入）**，或者关注公众号：**简说基因**。

![](/assets/media/wechat-qq-group.jpg)]]></content><author><name></name></author><category term="tools" /><summary type="html"><![CDATA[2023-11-06，Galaxy生信云平台 UseGalaxy.cn 新增circos圈图绘制工具。]]></summary></entry><entry><title type="html">新增热图绘制工具：heatmap2</title><link href="https://usegalaxy.github.io/posts/2023/11/05/tool-update/" rel="alternate" type="text/html" title="新增热图绘制工具：heatmap2" /><published>2023-11-05T00:00:00+00:00</published><updated>2023-11-05T00:00:00+00:00</updated><id>https://usegalaxy.github.io/posts/2023/11/05/tool-update</id><content type="html" xml:base="https://usegalaxy.github.io/posts/2023/11/05/tool-update/"><![CDATA[2023-11-05，Galaxy生信云平台 [UseGalaxy.cn](https://usegalaxy.cn) 新增绘制热图工具。

## Graph/Display Data

- heatmap2 (Galaxy Version 3.1.3+galaxy0)

## 使用方法

进入网址：

[https://usegalaxy.cn/root?tool_id=toolshed.g2.bx.psu.edu/repos/iuc/ggplot2_heatmap2/ggplot2_heatmap2/3.1.3+galaxy0](https://usegalaxy.cn/root?tool_id=toolshed.g2.bx.psu.edu/repos/iuc/ggplot2_heatmap2/ggplot2_heatmap2/3.1.3+galaxy0)

### 数据准备

需要准备矩阵形数据，可用平台的测试数据（heatmap_test.tsv）练习，如下表：

![](/assets/img/231105-tool-update-heatmap_data.png)

- 第1列，是基因名，或其他名称
- 第2 - 最后一列，是各样本的表达量，或其他所要展示的值

### 默认参数绘图

选择输入数据表，其他参数保持默认，点击**Run Tool**，得到结果：

![](/assets/img/231105-tool-update-heatmap.png)

### 设置标题

- **Plot title**: Heatmap by UseGalaxy.cn
- **key title**: FPKM

效果图：

![](/assets/img/231105-tool-update-heatmap-title.png) 

### 行列聚类

可以设置是否聚类，聚类行或者列（默认行/列都聚类）。还可以设置计算距离的算法，以及聚类。在这里选择**ward.D2**聚类方法，如图：

![](/assets/img/231105-tool-update-heatmap-clustering.png)

结果如下：

![](/assets/img/231105-tool-update-heatmap-clustering-result.png)

### 标准化数据

在聚类之前，可以对数据进行标准化。

- 按行标准化

![](/assets/img/231105-tool-update-heatmap-scale-row.png)

- 按列标准化

![](/assets/img/231105-tool-update-heatmap-scale-col.png)

### 调色板

本热图工具支持R语言流行的RColorBrewer包中的颜色方案，或者指定2个颜色之间的渐变，或3个颜色之间的渐变。

这里选择 RColorBrewer 包的 Blues 颜色方案，结果如图：

![](/assets/img/231105-tool-update-heatmap-color-blues.png)


## 友情提示

使用问题请加入**Galaxy中国交流群: 925694514（QQ群，免费加入）**，或者关注公众号：**简说基因**。

![](/assets/media/wechat-qq-group.jpg)]]></content><author><name></name></author><category term="tools" /><summary type="html"><![CDATA[2023-11-05，Galaxy生信云平台 UseGalaxy.cn 新增绘制热图工具。]]></summary></entry><entry><title type="html">新增单因素分析，多因素分析两个工具</title><link href="https://usegalaxy.github.io/posts/2023/11/04/tool-update/" rel="alternate" type="text/html" title="新增单因素分析，多因素分析两个工具" /><published>2023-11-04T00:00:00+00:00</published><updated>2023-11-04T00:00:00+00:00</updated><id>https://usegalaxy.github.io/posts/2023/11/04/tool-update</id><content type="html" xml:base="https://usegalaxy.github.io/posts/2023/11/04/tool-update/"><![CDATA[2023-11-04，Galaxy生信云平台 [UseGalaxy.cn](https://usegalaxy.cn) 新增 2 个工具。

## Cancer Research

- 单因素分析 with survival (Galaxy Version 0.5)
- 多因素分析 with survival (Galaxy Version 0.7)

## 使用方法

### 单因素分析

- 第一步：上传生存数据表，或选择测试数据集：Data libraries > Table data > survival_lung.tsv
- 第二步：选择**生存时间**所在的列
- 第三步：选择**终点事件**所在的列
- 第四步：填写终点事件标志（通常是1，保持默认即可）
- 第五步：选择是否自动进行**多因素分析**，如果选择**是**，则会要求给定一个*P*值，单因素分析结果中小于给定*P*值的因素会自动进行后续多因素分析步骤
- 最后：点击**Run Tool**，等待计算结果

操作步骤如下图：

![](/assets/img/231104-tool-update-univariate.png)

### 多因素分析

操作步骤与单因素分析类似，如下图：

![](/assets/img/231104-tool-update-multivariate.png)


## 最后

Galaxy生信云平台 [usegalaxy.cn](https://usegalaxy.cn) 致力于降低生信分析门槛，将许多常见的生信分析都放到云上，用户无需安装本地软件或R包，只需要上传数据，点击鼠标即可进行生信分析。]]></content><author><name></name></author><category term="tools" /><summary type="html"><![CDATA[2023-11-04，Galaxy生信云平台 UseGalaxy.cn 新增 2 个工具。]]></summary></entry><entry><title type="html">新增生存曲线绘制、肿瘤基因通路注释工具</title><link href="https://usegalaxy.github.io/posts/2023/10/26/tool-update/" rel="alternate" type="text/html" title="新增生存曲线绘制、肿瘤基因通路注释工具" /><published>2023-10-26T00:00:00+00:00</published><updated>2023-10-26T00:00:00+00:00</updated><id>https://usegalaxy.github.io/posts/2023/10/26/tool-update</id><content type="html" xml:base="https://usegalaxy.github.io/posts/2023/10/26/tool-update/"><![CDATA[2023-10-26，Galaxy生信云平台 [UseGalaxy.cn](https://usegalaxy.cn) 新增 2 个工具。

## Cancer Research

- 生存曲线 Kaplan-Meier curve ploter
- 肿瘤通路注释 Gene to oncogenic pathway mapper


## 部分结果展示

### 生存曲线 Kaplan-Meier curve ploter

生存曲线-不分层：

![](/assets/img/231026-tool-update-survival.png)

生存曲线-分层：

![](/assets/img/231026-tool-update-survival-strata.png)

生存分析是一种统计方法，用于评估特定群体在一段特定时间内存活或生存的概率。它通常用于研究患者的生存率或存活时间，特别是在临床医学和流行病学研究中。生存分析主要涉及观察患者或个体在一定时间内是否存活，并在研究过程中考虑各种可能的因素，如治疗方法、药物治疗、生活方式等。

### 肿瘤通路注释 Gene to oncogenic pathway mapper

指定基因所在的列，本工具可以将基因名转换成通路名（TCGA 10 条oncogenic通路和 TCGA 10 条DDR通路）。

注释前：

![](/assets/img/231026-tool-update-gene2pathway-before.png)

注释后：

![](/assets/img/231026-tool-update-gene2pathway-after.png)

**TCGA 10 条 oncogenic 通路：**

- Cell_Cycle
- Hippo
- MYC
- NOTCH
- NRF2
- PI3K
- TGF_Beta
- RTK_RAS
- TP53
- WNT

**TCGA 10 条 DDR 通路：**

- BER
- DR
- NHEJ
- NER
- MMR
-  HR
- TLS
- FA
- NP
- Other

## 最后

谁不想点点鼠标就把活儿干了，早点下班不好吗？

Galaxy生信云平台 [usegalaxy.cn](https://usegalaxy.cn) 致力于降低生信分析门槛，将许多常见的生信分析都放到云上，用户无需安装本地软件或R包，只需要上传数据，点击鼠标即可进行生信分析。]]></content><author><name></name></author><category term="tools" /><summary type="html"><![CDATA[2023-10-26，Galaxy生信云平台 UseGalaxy.cn 新增 2 个工具。]]></summary></entry><entry><title type="html">Maftools高效地汇总、分析、注释和可视化肿瘤基因突变MAF文件</title><link href="https://usegalaxy.github.io/posts/2023/10/25/tool-update/" rel="alternate" type="text/html" title="Maftools高效地汇总、分析、注释和可视化肿瘤基因突变MAF文件" /><published>2023-10-25T00:00:00+00:00</published><updated>2023-10-25T00:00:00+00:00</updated><id>https://usegalaxy.github.io/posts/2023/10/25/tool-update</id><content type="html" xml:base="https://usegalaxy.github.io/posts/2023/10/25/tool-update/"><![CDATA[2023-10-25，Galaxy中国镜像站 [UseGalaxy.cn](https://usegalaxy.cn) 平台新增 5 个工具。

## MAF Tools

- Maftools-突变景观图: 绘制肿瘤基因突变景观图
- Maftools-突变汇总: 汇总MAF文件中的突变信息
- Maftools-共突变与互斥突变: 计算共突变和互斥突变
- Maftools-队列比较：比较两个队列之间基因突变的差异
- Maftools-突变过滤: 一键过滤同义突变

## 部分结果展示

### Maftools-突变景观图

![](/assets/img/231025-galaxy-maftools-oncoplot.png)

肿瘤突变景观图是一种用于展示肿瘤样本中基因突变信息的图表。横坐标代表不同肿瘤样本，可以是来自不同患者的样本或同一患者不同时间点的样本。纵坐标通常表示不同的基因或基因组区域，其中可能包括与肿瘤发生和发展相关的关键基因。

### Maftools-突变汇总

![](/assets/img/231025-galaxy-maftools-summary.png)

计算 MAF 文件的摘要，该摘要以堆叠条形图的形式展示每个样本中突变的数量，并按 Variant_Classification 将汇总的变异类型显示为箱线图。


### Maftools-共突变与互斥突变

![](/assets/img/231025-galaxy-maftools-somaticInteraction.png)

肿瘤基因的共突变和互斥突变是研究肿瘤遗传学时经常遇到的概念。

**共突变（Co-occurring Mutations）：**指两个或多个基因在同一肿瘤样本中同时发生突变。共突变可能是因为这些基因在同一通路或功能网络中相互作用，共同参与了肿瘤的发展过程。共突变的分析可以帮助我们理解肿瘤发展的关键途径，找到潜在的靶向治疗机会。

**互斥突变（Mutually Exclusive Mutations）：**指两个或多个基因突变在同一肿瘤样本中不会同时出现。这表明这些基因可能在肿瘤的发展中具有相似的功能或通路，突变发生在其中一个基因的同时抑制了其他基因的突变。互斥突变的分析有助于识别肿瘤发展过程中相互竞争的关键基因，并为潜在的治疗靶点提供线索。
通过研究共突变和互斥突变，我们可以深入了解肿瘤细胞内复杂的遗传变异模式，识别肿瘤发展过程中的关键基因和通路，为精准医疗和个体化治疗提供重要的理论支持。

### Maftools-队列比较

![](/assets/img/231025-galaxy-maftools-compare-cohort.png)

癌症在突变模式方面存在差异。我们可以比较两个不同的队列来检测这种不同的突变基因。例如，Madan等人最近的一篇文章表明，复发性急性早幼粒细胞白血病（APL）患者往往在PML和RARA基因中具有突变，在疾病的初期阶段则不存在这些突变。可以使用mafCompare函数检测两个队列（在本例中为初期和复发性APL）之间的差异，该函数对两个队列中的所有基因执行Fisher检验以检测不同的突变基因。

### Maftools-突变过滤

将 MAF 文件拆分成两个文件：一个包含同义突变，另一个包含非同义突变。

![](/assets/img/231025-galaxy-maftools-filter-non-silent.png)

![](/assets/img/231025-galaxy-maftools-filter-silent.png)

**非同义突变类型：**

"Frame_Shift_Del", "Frame_Shift_Ins", "Splice_Site", "Translation_Start_Site","Nonsense_Mutation", "Nonstop_Mutation", "In_Frame_Del","In_Frame_Ins", "Missense_Mutation"

这些突变具有高度或中等的突变后果。

## 最后

生信分析已经进入2.0时代，即云平台时代。

Galaxy生信云平台 [usegalaxy.cn](https://usegalaxy.cn) 致力于降低生信分析门槛，将许多常见的生信分析都放到云上，用户无需安装本地软件或R包，只需要上传数据，点击鼠标即可进行生信分析。]]></content><author><name></name></author><category term="tools" /><summary type="html"><![CDATA[2023-10-25，Galaxy中国镜像站 UseGalaxy.cn 平台新增 5 个工具。]]></summary></entry><entry><title type="html">如何制作临床信息表/三线表/Table 1</title><link href="https://usegalaxy.github.io/posts/2023/10/24/tool-update/" rel="alternate" type="text/html" title="如何制作临床信息表/三线表/Table 1" /><published>2023-10-24T00:00:00+00:00</published><updated>2023-10-24T00:00:00+00:00</updated><id>https://usegalaxy.github.io/posts/2023/10/24/tool-update</id><content type="html" xml:base="https://usegalaxy.github.io/posts/2023/10/24/tool-update/"><![CDATA[临床基线表是在临床研究中用于记录和收集患者初始诊断、治疗前的基本信息以及其他关键变量的表格或数据库。这些基本信息通常被用作研究的起点，用于建立患者的初始状态或基线状态。

本文介绍通过 Galaxy生信云平台 [usegalaxy.cn](https://usegalaxy.cn) 制作临床基线表/三线表的方法。

## 1. 数据准备

要制作临床基线表/三线表，首先要将临床信息整理成表格：

- 每一行是一个样本；

- 每一列是一个变量。

比如：

![示例数据](/assets/img/20231024-tableone-pbc.png)

本文将以平台自带的一个测试数据集（tableone_pbc.tsv）为例进行演示。


## 2. Galaxy平台操作步骤

### 2.1 选择工具

- 进入Galaxy生信云平台：[usegalaxy.cn](https://usegalaxy.cn)（建议使用Chrome或Firefox浏览器）。

![Galaxy云平台](/assets/img/20231024-galaxy-home.png)

- 主页左侧工具列表中，找到 Statistics > 临床基线表，点击进入工具界面。

![](/assets/img/20231024-galaxy-home-tableone.png)

### 2.2 选择测试数据集

点击输入数据最右边按钮 Browse datasets > Data libraries > Table data > tableone_pbc.tsv，如图：

![](/assets/img/20231024-galaxy-click1-browse-datasets.png)
![](/assets/img/20231024-galaxy-click2-data-libraries.png)
![](/assets/img/20231024-galaxy-click3-table-data.png)
![](/assets/img/20231024-galaxy-click4-tableone-pbc.png)


### 2.3 运行工具

完成数据集的选择后，我们保持其他参数设定框为空，以默认参数运行工具：

![](/assets/img/20231024-galaxy-tableone-run-tool.png)
![](/assets/img/20231024-galaxy-submit-done.png)
![](/assets/img/20231024-galaxy-run-tool-done.png)

### 2.3 查看结果

点击眼睛图标，查看计算结果：

![](/assets/img/20231024-galaxy-check-result.png)

结果展示：

![](/assets/img/20231024-galaxy-show-result.png)

### 2.4 下载结果

点击显示数据详情：

![](/assets/img/20231024-galaxy-click-datasets.png)

点击磁盘图标下载结果文件：

![](/assets/img/20231024-galaxy-download.png)

结果是一个文本文件，可以用文本编辑器或者Excel打开：

![](/assets/img/20231024-galaxy-result-table.png)


## 3. 调整参数重新计算

在Galaxy平台上重新调整参数再次运行工具是非常方便的，只需要点击界面中的“重运行”按钮：

![](/assets/img/20231024-galaxy-rerun.png)

可以看到，界面中出现了刚才运行任务时的参数设置，也就是说，当重新运行任务时，上一次运行的参数得到了保留，我们只需要进行必要的修改，即可再次运行工具。

![](/assets/img/20231024-galaxy-rerun-ui.png)

进行必要的修改，如：

- 指定一个分类变量：sex
- 指定两个符合正态分布的变量：trig, platelet（仅仅是用于举例，实际要依变量的性质而定）
- 指定两个不符合正态分布的变量：time, age（仅仅是用于举例，实际要依变量的性质而定）
- 指定两个分类变量：status, trt。当分类变量以数值表示时，必须明确指定其为分类变量，否则会自动按数值变量处理。

![](/assets/img/20231024-galaxy-rerun-ui-setting.png)

再次点击 Run Tool 运行，查看结果：

![](/assets/img/20231024-galaxy-rerun-result.png)

可以看到：

- 对于符合正态分布的变量，计算了平均数和标准差：mean(SD)
- 对于不符合正态分布的变量，计算了中位数和上下四分位数：median(IQR)
- 对于分类变量，计算了它们的数量及其中总数中的百分比（%），以数值表示的分类变量得到了正确的处理

此外，表中还展示了 p 值 ，关于检验方法：

- 正态分布的数据，进行了参数检验
- 不符合正态分布的数据，进行了非参数检验
- 分类数据，进行了Fisher精确检验

限于篇幅，本文就介绍到这里，更多生信工具，请到Galaxy生信云平台 [usegalaxy.cn](https://usegalaxy.cn) 网站进行探索。

## 3. 最后

生信分析已经进入2.0时代，即云平台时代。

Galaxy生信云平台 [usegalaxy.cn](https://usegalaxy.cn) 致力于降低生信分析门槛，将许多常见的生信分析都放到云上，用户无需安装本地软件或R包，只需要上传数据，点击鼠标即可进行生信分析。]]></content><author><name></name></author><category term="tools" /><summary type="html"><![CDATA[临床基线表是在临床研究中用于记录和收集患者初始诊断、治疗前的基本信息以及其他关键变量的表格或数据库。这些基本信息通常被用作研究的起点，用于建立患者的初始状态或基线状态。]]></summary></entry></feed>